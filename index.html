<!DOCTYPE html>
<html lang="ca">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Corferit - Tirades</title>

    <style>
      body {
        font-family: sans-serif;
        background: #444;
        color: #eee;
        text-align: center;
        padding: 20px;
      }
      .page {
        max-width: 350px;
        margin: 40px auto;
        padding: 32px 40px;
        background: #222;
        border-radius: 10px;
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.35);
      }
      .title {
        display: inline-flex;
        align-items: center;
        gap: 0.6rem;
      }
      .title::before {
        content: "";
        width: 36px;
        height: 36px;

        background: url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iMTE3LjkyMjU5bW0iCiAgIGhlaWdodD0iMTk4LjY0OTJtbSIKICAgdmlld0JveD0iMCAwIDExNy45MjI1OSAxOTguNjQ5MiIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0ic3ZnNSIKICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcwogICAgIGlkPSJkZWZzMiIgLz48ZwogICAgIGlkPSJsYXllcjIiCiAgICAgc3R5bGU9ImRpc3BsYXk6aW5saW5lIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMy45MDE3NTMsLTM2Ljc5NTgyNSkiPjxnCiAgICAgICBpZD0iZzE1OTMiPjxwYXRoCiAgICAgICAgIGlkPSJwYXRoNDEyIgogICAgICAgICBzdHlsZT0iZGlzcGxheTppbmxpbmU7ZmlsbDojODAwMDgwO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIGQ9Im0gNDQuNzYxMTEzLDEzNy42MzY1OCAtMTcuODAxMDAzLDM4LjI3MTA1IC0xMS41NTg4MDUsMTcuMTY4NSA5LjAwMDIzNCwtMjMuNzU5MTQgMTUuMTcxMzc1LC0zMC4zNTc4MSB6IG0gLTE3LjgwOTA3OCwzOC4yNzg5MyAzMC40NzUyMTYsMjQuNzA5ODIgNi4zMjY4OTcsMzMuMzE5NzMgLTI3LjE3MDE3OCwtNC4zODk5MiAtMjEuMTcwMDY3LC0zNi40NjQ5NSB6IG0gNTkuNDY5ODMxLC0zNy4wNzQ1IDcuMzc2NjQyLDM3LjA0NTcxIDI4LjIyNDMwMiwyMC44NzY2IDYuNzQ3MDQsLTIyLjg5Nzc2IC0yMS40OTY1MSwtMzYuNDE4MDYgeiBtIC0yOC45ODQ4ODIsNjEuNzk3MzggNi4zMTk5MDIsMzMuMjg3ODYgMzcuOTU1NzQ0LC0wLjI2ODQyIDIwLjMyMDU0LC0zNi44NzYzNSAtMjguMjM3MDE4LC0yMC45MDIyNyB6IG0gLTEyLjc1NzE2NiwtNjMuMDUzMDkgNDEuNzQ0MTI0LDEuMjQ5ODQgNy4zNjg3MDYsMzcuMDQ4NTEgLTM2LjM1NjY0MSwyNC43MzUxMyAtMzAuNDU1ODQ4LC0yNC42ODY5MSB6IiAvPjxnCiAgICAgICAgIGlkPSJnMTU4NCI+PHBhdGgKICAgICAgICAgICBpZD0icGF0aDE1MTEiCiAgICAgICAgICAgc3R5bGU9ImZpbGw6I2FhODgwMDtzdHJva2U6IzgwNjYwMDtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDM2Ljk4OTk2OSwyMDguNjM5NjUgNy4xNzYyMiw4LjE5MDAyIC0wLjk3MzAxMywtNS43MzEzNSB6IG0gLTEwLjEwNTI0NywtMTAuMDU4OCAxNS40OTY2MTIsNy42NjEyMyAtMC44MjkxNiwtMy43NDAwNCA0LjIxOTU1MSwxLjk2ODUxIDEuMDk1MDU4LDMuNTc3NTMgNC4xMjg2NDMsMi4wNDQyNiAxLjAzNTk0OSw1Ljc1NTQ5IC00LjM0NzU4OCwtMi42NDQzMSAwLjgyNjQ5MywxMS40MTQwOCAtMjAuNTI1MzQxLC0yMC42MTAyNSB6IiAvPjxwYXRoCiAgICAgICAgICAgc3R5bGU9ImZpbGw6I2FhODgwMDtzdHJva2U6IzgwNjYwMDtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDc4LjAyMTQ5MSwxOTcuNTI4MDkgMTMuMzAyOTcyLDIzLjA4NDEyIDQuNjg5NDg4LC0zLjM3MDg5IGMgMC41ODI4NzUsLTQuNzg0IDIuNTE0MzEzLC04LjAzMDYgNC45MjU4ODksLTEwLjcyOTgzIGwgLTIuNjA5NDAxLC00LjE1NDUyIC01LjgxNTAwMiw3LjMxMzczIC04Ljg1ODgzNywtMTYuMTU1ODQgeiIKICAgICAgICAgICBpZD0icGF0aDE1NjgiIC8+PHBhdGgKICAgICAgICAgICBzdHlsZT0iZmlsbDojYWE4ODAwO3N0cm9rZTojODA2NjAwO3N0cm9rZS13aWR0aDowLjQ5OTk5OTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICAgIGQ9Im0gMTAyLjk2OTAyLDE0Ni40NDk5MSAxMi44OTc1OSwxMC40ODMyIDAuNDU0MiwyLjg5OTIyIGMgLTQuODc0ODEsMy40OTgyMyAtNy41MDM2Myw5LjI3MjkxIC03LjM5NTgyLDE2LjE1MzQ1IGwgLTMuOTg3NDYsLTQuMjEwNCBjIDAuNzg2NTcsLTQuOTkxIDIuNTYzNDEsLTkuNjMyNTEgNi41Mjk4NywtMTMuNTAxMyBsIC04LjcwMjMzLC03LjM0ODcxIHoiCiAgICAgICAgICAgaWQ9InBhdGgxNTcwIiAvPjxwYXRoCiAgICAgICAgICAgc3R5bGU9ImZpbGw6I2FhODgwMDtzdHJva2U6IzgwNjYwMDtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDM5LjY2ODI3OCwxNzAuMzE3OTUgYyAyLjU0Mzk5NCwtMy43MjczMyA0LjUxODkzOSwtNy41NTAwMiA0LjAwNDUyNCwtMTEuNzg5ODkgbCA0LjQzODI0OCwtMi43MTA2NSAxNS44Mjc4NDgsMjUuMjc5MzQgLTUuNDYxMzM5LDMuNDU2MzcgLTEwLjg2NjYzMywtMTcuODYyMjUgLTUuMjkxMzMzLDcuNzczMzUgeiIKICAgICAgICAgICBpZD0icGF0aDE1NzIiIC8+PHBhdGgKICAgICAgICAgICBpZD0icGF0aDE1NzQiCiAgICAgICAgICAgc3R5bGU9ImZpbGw6I2FhODgwMDtzdHJva2U6IzgwNjYwMDtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDYxLjU2NzA3NSwxNTUuNTUxNTcgYyAxLjYzMzg2OSw1LjY3MTQ3IDQuMTc0NjI1LDEwLjYxODg0IDkuNDQ3MjYyLDE0LjU0MDU3IDEuODc4NDI2LDEuMzk3MTUgNS41MTkyMjcsLTEuMDQxNjQgNS4xNDEzNDEsLTMuNjY3NTggLTAuNjM5ODc2LC00LjQ0NjQ5IC0zLjA4NDMxOSwtOC43NDM2IC04LjQxNDA0NiwtMTQuMDk4MTMgLTIuNDU5NTAyLC0yLjQ3MDk1IC01LjcyMzcxNywwLjQ3ODY1IC02LjE3NDU1NywzLjIyNTE0IHogbSAtNS42ODE3MzEsLTAuNTg4ODkgYyAwLjM1MTc2NCwtMi44OTgxIDIuMTU1OTAxLC01Ljg4MTQ3IDQuNjI2ODU2LC03LjQzNjE3IDIuNTE5NTExLC0xLjU4NTI1IDYuMDczNzg0LC0xLjk3MjQyIDguODc3MjA1LC0wLjk3MTUzIDMuODQ0NjM0LDEuMzcyNjMgNi41MjM1NjYsNS4yMTM0OCA4LjU3NzY5Myw4Ljc0MTM1IDIuMzk1ODU0LDQuMTE0NzggNC44NzUzNzEsOS4wNjczMiAzLjkyODIzNCwxMy43MzM2MyAtMC40NjAwMDcsMi4yNjYzNCAtMi4zMDcwMzUsNC4zMjkwOSAtNC4zNTc0ODMsNS4zOTg0NyAtMi42MjAxMDYsMS4zNjY0NyAtNi4wNDk5NywxLjU4MTMgLTguODQzNTM0LDAuNjE3ODYgLTMuNzY1Mzc0LC0xLjI5ODU5IC02LjcwMzI5OCwtNC42NjMxNCAtOC44NzI0OTUsLTguMDAzNjQgLTIuMzA2NDY2LC0zLjU1MTg5IC00LjQ0Njc3MiwtNy44NzU3NyAtMy45MzY0NzYsLTEyLjA3OTk3IHoiIC8+PC9nPjwvZz48ZwogICAgICAgaWQ9ImcxNjkyIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMS41ODc1LDAuNTI5MTY2NjcpIj48cGF0aAogICAgICAgICBpZD0icGF0aDUzMCIKICAgICAgICAgc3R5bGU9ImRpc3BsYXk6aW5saW5lO2ZpbGw6I2ZmZDQyYTtzdHJva2U6IzFhMWExYTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICBkPSJNIDUxLjE3OTE3NSwzNy43NjY2MTggMzguMzYwOTY2LDM5LjcxNTkyMiAxNy42OTU1NjEsNzQuOTUzNTY0IDE2LjYyMjI1MSw5Ni43MTY0ODEgMzYuODA5NzkzLDc0LjExMzQ3NyBaIG0gMC4wMTUyMywwLjAwMjMgTCAzNi44MzI0NTMsNzQuMTMzNDM3IDcyLjE2NzMyNCw5OC4wMDg1MTIgMTA4Ljk3MjM3LDc1LjEwNjYzOSA5NC4yNTA2MjEsMzcuNzkyNDk3IFogbSA0My4wNDM3MTIsMC4wNDg5NyAxNC43NDkyOTMsMzcuMjc0ODYgMTkuNzQ0NjYsMjMuMDE5NjA3IC0yLjY0MzEzLC0yMi44MDk1MSAtMTkuNTA1MjYsLTM0LjY2NzY1MSB6IE0gMzYuODI1MTY5LDc0LjExMjY4MiAxNi42MTAyNDQsOTYuNzE2Mjc3IDM3LjIxNjgzOSwxMzQuNDU2MjQgNzIuNjAxMDUsMTM1Ljk2MzgxIDcyLjE0NjcyNSw5OC4wMjA0OTggWiBtIDcyLjE1NjA2MSwwLjk5MzUwMiAtMzYuODI2NTE3LDIyLjg5NzE5NyAwLjQ0NjA0MSwzNy45MzI4NDkgMzMuNzU5MTQ2LC0xLjYyODgyIDIyLjM3Njk4LC0zNi4xODg4NzMgeiIgLz48ZwogICAgICAgICBpZD0iZzE2ODAiPjxwYXRoCiAgICAgICAgICAgc3R5bGU9ImZpbGw6Izg5MmNhMDtzdHJva2U6IzY3MjE3ODtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDM0LjMwOTE5LDEwNS4zNzkwOCA3LjI1OTk2OCwxMi45MTQyMyAxMS45Mjk4OTYsLTEuMzc4NiBjIDAsMCAwLjA0ODczLC0wLjA4IC0yLjAzOTkzLC00LjUyMDA4IC0xLjc0NjIyNywtMS43NDYyMyAtNS4wOTY5NTQsLTMuNTQxMzEgLTUuMDYwMjAxLC02LjIxMTcgMC4wMTg3NSwtMS4zNjIwOSAxLjMyMDU2NCwtMi44OTEzMyAyLjY2NzI5NCwtMy4wOTYxOSAxLjk2ODc4OSwtMC4yOTk0OCA0LjE0MTQ5OSwxLjM5OTc5IDUuMDY4ODU4LDMuMTYyMTMgMC45Mzk1OTEsMS43ODU1OCAxLjQyNzA0NywzLjY0NzIgLTAuMjY3NzI5LDYuMDQ3MTkgMi43ODYxOTYsNC4yNTQ1IDIuNzQzODgyLDQuMjU5MDIgMi43NDM4ODIsNC4yNTkwMiAwLDAgMi4zOTkzNSwtMi4zMDc0OCAyLjg5NTA2MywtMy44Mjg3OSAwLjU4NDQyNCwtMS43OTM1NiAwLjQ5ODA4MSwtMy44Njg3MyAtMC4wOTg1NywtNS42NTgyNiAtMC43NDQ1ODksLTIuMjMzMjQgLTIuMzQyODk1LC00LjIwMDU4IC00LjEzOTEzNCwtNS43MjIxOSAtMS41NDc3MjMsLTEuMzExMDkgLTMuNDM0NTQ5LC0yLjQ3NjcyMyAtNS40NDk4MDUsLTIuNzA3MjUxIC0yLjIwNTA5MiwtMC4yNTIyNDMgLTQuOTQ0NjM4LC0wLjA2NTQ1IC02LjQ3ODA5MywxLjUzOTEwMSAtMS40NjYwNTgsMS41MzQwMyAtMS41MjYzNyw0LjE1ODY1IC0xLjE4OTQ2MSw2LjI1MzY2IDAuMjgzOTA4LDEuNzY1NDMgMS41NzU4MDIsMy4yMjcgMi42MDQwMjQsNC42ODk5MSAwLjQ0NjQ2MywwLjYzNTIxIDEuNTMzMTEyLDEuNzUzNTUgMS41MzMxMTIsMS43NTM1NSBsIC0zLjIwMDA4NywwLjQxNjkxIC01LjY2NjI1MSwtOS40Njk3MiB6IgogICAgICAgICAgIGlkPSJwYXRoMTU5NSIgLz48cGF0aAogICAgICAgICAgIHN0eWxlPSJmaWxsOiM4OTJjYTA7c3Ryb2tlOiM2NzIxNzg7c3Ryb2tlLXdpZHRoOjAuNDk5OTk5O3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgICAgZD0ibSA4NC42Njg4NTYsMTExLjI4MDQ1IGMgMS42MjU3NjksLTIuNDA4NTMgMi40MzE4NDMsLTUuMTk2MjkgMi43NjUwNDcsLTguMjAyODMgbCAyLjY1NzIwMiwtMS44MDYyNCA3LjEwNDYzNywxOS4yNzM2MiAtMy40OTYzOTUsMi4xMzA5NCAtNC40NTg5NywtMTIuMTU1MzMgYyAtMC41NjIwNzQsMS41MjI2MyAtMS41NjM2OTQsMi45MTgyNCAtMi43ODAxMTQsNC4yNTE3NyB6IgogICAgICAgICAgIGlkPSJwYXRoMTY1MSIgLz48cGF0aAogICAgICAgICAgIGlkPSJwYXRoMTY1NSIKICAgICAgICAgICBzdHlsZT0iZmlsbDojODkyY2EwO3N0cm9rZTojNjcyMTc4O3N0cm9rZS13aWR0aDowLjQ5OTk5OTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICAgIGQ9Im0gMTAyLjI3MjMxLDkzLjgwMjU0MyBjIC0wLjQ3OTMzLDAuMDAzIC0wLjk1MzMsMC4wNzgzIC0xLjM5MDEsMC4yMzY2NzggLTEuNDgzMjY1LDAuNTM3ODIzIC0yLjY3MTQ3NywxLjg1NzM0IC0zLjQ3MjEzNSwzLjIxNjg1OCAtMC41OTcwNTgsMS4wMTM4MDMgLTAuNzk3MTA1LDIuMjUyMDE1IC0wLjg0MjMyNiwzLjQyNzcwMSAtMC4wNzI4LDEuODkyNzYgMC4zNzQ3NjEsMy43OTQ5OSAwLjkyODYyNiw1LjYwNjM3IDAuODY5NTE0LDIuODQzNyAxLjgxNjc0Miw1LjgyMDkzIDMuNzEzNDY1LDguMTExMTQgMC41MDM5MSwwLjYwODQ1IDEuMTcxMDEsMS4xNjMxNyAxLjkzMzIyLDEuMzcwOTcgMC45ODQ4MiwwLjI2ODQ5IDIuMTE4NSwwLjE1NTcyIDMuMDUxNDksLTAuMjU4MzggMC44OTc4NSwtMC4zOTg1IDEuNDgwMzcsLTEuMjk2MTUgMi4xNTQzOSwtMi4wMTA3MyAwLjY1NjExLC0wLjY5NTYgMS41MDU1NCwtMS4zMDg2NiAxLjgzMTQxLC0yLjIwNzYyIDAuNjYzNjYsLTEuODMwNzEgMC4zMzI5MSwtMy45MjA0MyAwLjAxNzYsLTUuODQyMDIgLTAuMjc0OTEsLTEuNjc1MjkgLTAuOTcyMzUsLTMuMjYxNDggLTEuNjQyMjcsLTQuODIxNDEgLTAuNzAzODIsLTEuNjM4ODU0IC0xLjQxMDE2LC0zLjMxNDU3IC0yLjQ4NDYxLC00LjczODIxMiAtMC40ODg1MywtMC42NDczMTMgLTEuMDE3NjksLTEuMzU3NTAzIC0xLjc2MjY4LC0xLjY3NzkzMyAtMC42MjM4LC0wLjI2ODMwNyAtMS4zMzU0OCwtMC40MTc3ODQgLTIuMDM2MDUsLTAuNDEzNDEyIHogbSAtMC4wNzM0LDMuOTk0NTg4IGMgMC4zNDI5MSwtMC4wMDY2IDAuNzA4MTcsMC4xNjExODkgMC45NTAzMywwLjM5NzkwOSAxLjk0ODMzLDEuOTA0NTkgMi4yNjYzMyw0Ljk5NDkzIDIuODc5NDEsNy42NDk2NiAwLjI2ODQ0LDEuMTYyNDkgMC40NDM5MiwyLjM3NTQyIDAuMzM1OSwzLjU2MzYxIC0wLjAzMTUsMC4zNDY5IC0wLjEzMjAyLDAuNjkyMyAtMC4yODQyMiwxLjAwNTYyIC0wLjEyNzgsMC4yNjMwOSAtMC4yNDU2OSwwLjU5ODQgLTAuNTE2MjUsMC43MDk1MiAtMC41MTU1LDAuMjExNzEgLTEuMjE0MDcsMC4wNzY5IC0xLjY1MDAzLC0wLjI3MDI3IC0yLjI5NTg4LC0xLjgyODA5IC0yLjUzNjM3LC01LjMyNDUzIC0zLjMzMjEsLTguMTQ5MzcgLTAuMTUyNTQsLTAuNTQxNSAtMC4yODcyOCwtMS4xMDMxOSAtMC4yNzA3OCwtMS42NjU1MyAwLjAyMjEsLTAuNzUyNzIgMC4wOTczLC0xLjU2NDAwOSAwLjQ5MjQ4LC0yLjIwNTAzNiAwLjI4MjQ4LC0wLjQ1ODIzNCAwLjcxOTg4LC0wLjkyOTQyNyAxLjI1MDA1LC0xLjAyMjY3NyAwLjA0NzYsLTAuMDA4NCAwLjA5NjIsLTAuMDEyNDkgMC4xNDUyMSwtMC4wMTM0NCB6IiAvPjxwYXRoCiAgICAgICAgICAgc3R5bGU9ImZpbGw6Izg5MmNhMDtzdHJva2U6IzY3MjE3ODtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDExNi43Mjc3NCw3Ni43MTAxNjkgYyAtMC4yNzY2NywtMS41MjU5MzggLTEuMTY3MzMsLTMuMjY3MjAxIC0yLjM2MTk0LC01LjExNTA2IGwgNi41NTUyNiw1LjY1MjUxNiAtMS4xNzE4MSwtMy45MDYyMDMgLTEwLjczNjk0LC04LjA0NjA4NyAwLjU2MjYsMi43MzU4ODkgYyAyLjA3MzA5LDIuMTA0NDg1IDQuMzMwMDksNC4wMzcxNSA1LjEwODMyLDcuMzUxMzc3IHoiCiAgICAgICAgICAgaWQ9InBhdGgxNjYyIiAvPjxwYXRoCiAgICAgICAgICAgc3R5bGU9ImZpbGw6Izg5MmNhMDtzdHJva2U6IzY3MjE3ODtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDEwOS44MDc5Miw2Mi4wNTk3ODUgMi4yMDU2LDEuNDg2MjQxIGMgLTAuNDMyOCwtMS4zNDk3NjkgLTAuOTc5OTQsLTMuMTI4MTA0IC0yLjI1Njg4LC00LjQ3Nzg3MyBsIDUuOTc5ODUsNC44OTI4NjkgLTAuODg1NTIsLTIuNTU3NzQgLTEwLjM5ODExLC04LjYwMTEwNCAwLjMzODI0LDIuMTI4NDIyIGMgMi4wNTU4NywyLjQ5OTAyNyAzLjk4ODE5LDQuOTU4NTU5IDUuMDE2ODIsNy4xMjkxODUgeiIKICAgICAgICAgICBpZD0icGF0aDE2NjQiIC8+PHBhdGgKICAgICAgICAgICBzdHlsZT0iZmlsbDojODkyY2EwO3N0cm9rZTojNjcyMTc4O3N0cm9rZS13aWR0aDowLjQ5OTk5OTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICAgIGQ9Im0gNTUuNjg2MTQyLDY3Ljc5ODYxMyAzLjAxMDE2NCwzLjc0MTA0MiBjIDEuMzgzODI5LC0xLjI2OTQ4OCAyLjM0MjIzMywtMi43NjMxMDYgMi4xNTQ3MjUsLTQuODYwNDM2IGwgOS44NDk5MDMsMTIuNzMzMzg4IDMuNTYwNjc3LC0yLjYyNDQ3NCAtMTQuNzI0NywtMTkuMTk4MjY5IC0zLjUyNzAwNywxLjU5MzM4MSBjIDAuMzcyNzk0LDIuNzM4MjExIDEuMDI1MzIzLDUuMzk4NjkgLTAuMzIzNzYyLDguNjE1MzY4IHoiCiAgICAgICAgICAgaWQ9InBhdGgxNjY2IiAvPjxwYXRoCiAgICAgICAgICAgc3R5bGU9ImZpbGw6Izg5MmNhMDtzdHJva2U6IzY3MjE3ODtzdHJva2Utd2lkdGg6MC40OTk5OTk7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgICBkPSJtIDcxLjg2Mjk0Niw1OC4zNjA3NyBjIDAsMCAtMC43MjUzLC0xLjQxNjA3OCAtMC41MTM1NDUsLTIuMTA3Mzk2IDAuMTY5NzI5LC0wLjU1NDExNSAwLjcxMzE4MSwtMS4wODggMS4yODcwNDIsLTEuMTY4ODM5IDAuODM1NzY0LC0wLjExNzczMyAxLjY4MDYzNiwwLjUxNTc2NiAyLjI3MTc1MiwxLjExODIxNCAwLjkxNjE0MSwwLjkzMzcwMyAxLjQ1ODcxLDIuMjYxNTU4IDEuNjY1OTAxLDMuNTUzMTQyIDAuMzA2ODMzLDEuOTEyNzMzIC0wLjY2MTQ2NywzLjgzMjcwNyAtMC42OTc0NDIsNS43Njk1NiAtMC4wMzQyNiwxLjg0NDIzOSAtMC4wODM3MSwzLjc1MTgzMiAwLjQ1OTYyNCw1LjUxNDU1MSAwLjQ3Nzg5LDEuNTUwMzk3IDIuMzk2NTQ4LDQuMjM2MjIgMi4zOTY1NDgsNC4yMzYyMiBsIDExLjA0MzcsLTYuNjEzNDU5IC0yLjM0NjE1NSwtMy45MTk1MjEgLTYuNjQ1OTUyLDMuNDk1OTI0IGMgMCwwIDAuMzQwMTg3LC00LjA3MjE0OSAwLjM0NTg5NSwtNi4xMTMxIDAuMDA0NiwtMS42NDM1NCAwLjI2Nzg2OSwtMy4zNjQ3NTQgLTAuMjUxMDA1LC00LjkyNDI0NSAtMC40NzM5NTMsLTEuNDI0NDggLTEuNDg4NTYsLTIuNjM5NjE5IC0yLjUxMTIxNiwtMy43Mzg2ODcgLTEuMTk4MjM3LC0xLjI4Nzc2OSAtMi40NDk5OTMsLTIuODI3NjQyIC00LjE1NzU3OCwtMy4yNDk4NjcgLTEuNDUwODc3LC0wLjM1ODc1MSAtMy4wNTc0MzMsMC4xNjU5NzYgLTQuNDEyMzQ4LDAuNzk2ODA5IC0xLjQzMTQwMywwLjY2NjQ0NSAtMi45OTEzODIsMS41ODgwNDMgLTMuNjQ0NzM2LDMuMDI1NDY4IC0wLjYzNjY5MSwxLjQwMDc2NSAtMC4zNTQ0NTUsMy4xNDkwNDYgMC4xMTQyLDQuNjE0NjExIDAuMjk2NjYxLDAuOTI3NzExIDAuNzE5NzIyLDIuMDkwNzQxIDEuNjM1OTk4LDIuNDIxMDM1IDMuOTIyNjk0LC0yLjY4MjEwMyAwLjAxNzA4LDAuMDcyODQgMy45NTkzMTcsLTIuNzEwNDIgeiIKICAgICAgICAgICBpZD0icGF0aDE2NjgiIC8+PHBhdGgKICAgICAgICAgICBzdHlsZT0iZmlsbDojODkyY2EwO3N0cm9rZTojNjcyMTc4O3N0cm9rZS13aWR0aDowLjQ5OTk5OTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICAgIGQ9Im0gMjguOTE1ODI4LDcxLjYzODE0OSAtMC4wMzQ2MywyLjk5NjYyNSBjIDAsMCAtMS4wNTk2MjcsMS4xMzY1OCAtMS43NDMzOTgsMS40NjczNDUgLTAuNjE3NjY5LDAuMjk4Nzg5IC0xLjQ2NTM2NSwwLjgyMDIzNSAtMi4wMTY3ODcsMC40MTE5MTcgLTAuNzYxOTU2LC0wLjU2NDIxNCAtMC4zNTczMjksLTEuODg3NjggLTAuMjY4NTYxLC0yLjgzMTYyNyAwLjExNDU3OCwtMS4yMTg0MTEgMC41MjY4OCwtMi40MDcwODMgMS4wMjE5NjQsLTMuNTI2MjU1IDAuNDg3Njk3LC0xLjEwMjQ3MiAxLjE5MTUyMiwtMi4xMDExNzggMS44OTMwNzksLTMuMDgxNTQxIDAuNTYyMDgzLC0wLjc4NTQ2MSAxLjE1MjcwNywtMS41NjEyNiAxLjg0NzQ1OCwtMi4yMzIyMzQgMC4zMzQ3OTksLTAuMzIzMzQxIDEuMTA2MDQ2LC0wLjg1MjMwMyAxLjEwNjA0NiwtMC44NTIzMDMgMCwwIDEuMDY1NTcyLC0yLjAyNzI3OCAxLjU4ODA1NiwtMy4wNDYyNDMgMC42NjU1NTcsLTEuMjk3OTkyIDEuMTYyMDMzLC0yLjY5MzEyIDEuOTcwMzMzLC0zLjkwNzM2OSAwLjQ0OTAwNSwtMC42NzQ1MDcgMC45OTE3MjIsLTEuNDM2NjM4IDEuNTU4MTY5LC0yLjAxNjAzNyAwLjY4MzE2NCwtMC42OTg3ODcgMS4yNDc3MDEsLTEuNTk2MTQ2IDIuMjA2MTc3LC0xLjc4Njc3MiAwLjQyOTMxOSwtMC4wODUzOSAwLjk4OTYzLDAuMDc1MiAxLjIzOTA3OCwwLjQzNDg5MyAwLjUyNjI5NiwwLjc1ODkwMiAwLjIyMzkyOCwxLjg5NDcxMSAwLjExMzcyLDIuODExNjQ4IC0wLjE3MDkyNiwxLjQyMjEyNiAtMC41OTI5MiwyLjgxNDYxNCAtMS4xMDI4OCw0LjE1MzEyIC0wLjUwMjE2MSwxLjMxODAzNSAtMS4zMjkzMDEsMi40ODk3OTQgLTIuMDYzMjQyLDMuNjk0MjUgLTAuNTE1OTg4LDAuODQ2Nzc4IC0xLjY0MzE2NiwyLjQ3OTgxNyAtMS42NDMxNjYsMi40Nzk4MTcgbCAtMC4xOTM2MzUsLTIuNzAwNzU4IGMgMCwwIDAuNTkwNzk5LC0wLjY1MTU4OSAwLjg0NDMwOSwtMS4wMDk2NDQgMC40NTY2NzksLTAuNjQ1MDA4IDAuOTEyMDY0LC0xLjMwNjg3NCAxLjIxMDI3MywtMi4wMzg3NjMgMC4yNjAwNjEsLTAuNjM4MjYyIDAuNTM4MjIzLC0xLjI2NjQxNyAwLjYwODYzMywtMS45NTIwMjEgMC4wNDc4NCwtMC40NjU4MzYgMC4wOTExNSwtMS4wNzEyNSAtMC4xNjc5MTEsLTEuNDYxMzUgLTAuMTU3NzM4LC0wLjIzNzUyMyAtMC40OTg4MzcsLTAuNDIxMTQzIC0wLjc3Njg4LC0wLjM1Nzk3MSAtMC41ODIyMTksMC4xMzIyODMgLTAuOTEwOTY3LDAuODMxNjc5IC0xLjI1NzIyMywxLjMxODA3OSAtMC42MTA0MzIsMC44NTc0OTkgLTEuMDY1MjM1LDEuODEzMjU3IC0xLjUyMzI4OCwyLjc2MDk0OSAtMC4zODU5LDAuNzk4NDA5IC0wLjY3NTQ0NiwxLjY0MzM2MiAtMC45MjU1NiwyLjQ5NDEzOCAtMC4wODQzMSwwLjI4Njc2OSAtMC4xOTI2MzgsMC44NzU3NzYgLTAuMTkyNjM4LDAuODc1Nzc2IGwgMC42ODU0NzIsMC42MDIyMjMgLTIuMzE3OTgzLDIuODcyMDg3IGMgMCwwIC0wLjA4NjIsLTEuMTUyMjg2IC0wLjQ1NDg3MiwtMS41NDA2MDMgLTAuMTQ4NTgxLC0wLjE1NjQ5OSAtMC40MDQwNTksLTAuMjc3OTgxIC0wLjYxMDU0NywtMC4yMTUyODQgLTAuNjUwNTgzLDAuMTk3NTM4IC0wLjg5MDIxNSwxLjAzOTc0OSAtMS4yMjE3NjEsMS42MzMzNDUgLTAuNDI2NDU4LDAuNzYzNTI1IC0wLjcwMTU3OCwxLjYwNTgyNSAtMC45NjQ2ODcsMi40Mzk4NTggLTAuMTQyMjY2LDAuNDUwOTcyIC0wLjMzODk1OSwwLjkwNjk3MyAtMC4zMjk4MzIsMS4zNzk3NjUgMC4wMDkzLDAuNDgzMjAyIC0wLjA3NDY5LDEuMjY3ODAyIDAuMzkxMjY4LDEuMzk2MDg0IDAuNDI1NjAzLDAuMTE3MTczIDAuNjY2MTA1LC0wLjU4MjkxOSAwLjk1OTY5NCwtMC45MTI1NzQgMC4yMDg3MjQsLTAuMjM0MzY2IDAuNTY1NzUyLC0wLjc1MjU3IDAuNTY1NzUyLC0wLjc1MjU3IHoiCiAgICAgICAgICAgaWQ9InBhdGgxNjcwIiAvPjwvZz48L2c+PC9nPjwvc3ZnPgo=") no-repeat center;

        background-size: contain;
      }
      .btn {
        margin: 10px;
        padding: 12px 22px;
        background: #444;
        color: #fff;
        border: none;
        border-radius: 10px;
        font-size: 20px;
        cursor: pointer;
      }
      #rstbtn {
        margin: 8px;
        padding: 8px 18px;
        background: #444;
        color: #fff;
        border: none;
        border-radius: 10px;
        font-size: 15px;
        cursor: pointer;
        width: auto;
        height: auto;
      }
      #result {
        margin-top: 20px;
        font-size: 26px;
      }
      #history {
        margin-top: 20px;
        text-align: left;
        width: auto;
        margin-left: auto;
        margin-right: auto;
        max-height: 300px;
        overflow-y: auto;
      }
      .esperan√ßa {
        color: #ffd700;
        font-weight: bold;
      }
      .por {
        color: #800080;
        font-weight: bold;
      }
      #roomLabel {
        opacity: 0.7;
        margin-bottom: 10px;
      }
      #loginBox input {
        padding: 8px;
        margin: 5px;
        width: 200px;
      }
      #loginBox {
        margin-bottom: 20px;
      }
      .dice-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 8px 0;
        background: #333;
        padding: 8px 10px;
        border-radius: 8px;
      }
      .dice-label {
        font-weight: bold;
      }
      .counter {
        display: flex;
        align-items: center;
        gap: 6px;
      }
      .counter button {
        background: #555;
        border: none;
        color: white;
        width: 26px;
        height: 26px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 16px;
      }
      .counter input {
        width: 40px;
        text-align: center;
        background: #222;
        border: 1px solid #555;
        color: white;
        border-radius: 6px;
        padding: 4px;
      }
      /* ===== ICONES DE DAUS ===== */
      .dice-icon {
        width: 38px;
        height: 38px;
        border-radius: 10px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 14px;
        margin-right: 6px;
        color: white;
        box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.6);
        transition: transform 0.2s ease;
      }
      /* Colors per tipus */
      /* D3 ‚Üí cercle */
      .d3 {
        background-color: #0661bb;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="28" fill="rgba(0,0,0,0.2)" stroke="black" stroke-width="2"/></svg>');
        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }

      /* D4 ‚Üí triangle */
      .d4 {
        background-color: #39b44a;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><polygon points="32,4 60,60 4,60" fill="rgba(0,0,0,0.2)" stroke="black" stroke-width="2"/></svg>');
        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }

      /* D6 ‚Üí quadrat */
      .d6 {
        background-color: #27bbd0;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><rect x="4" y="4" width="56" height="56" fill="rgba(0,0,0,0.2)" stroke="black" stroke-width="2"/></svg>');
        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }

      /* D8 ‚Üí octaedre (rombe) */
      .d8 {
        background-color: #9234e5;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><polygon points="32,4 60,32 32,60 4,32" fill="rgba(0,0,0,0.2)" stroke="black" stroke-width="2"/></svg>');
        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }

      /* D10 ‚Üí  */
      .d10 {
        background-color: #e03293;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><polygon points="32,4 56,20 56,44 32,60 8,44 8,20" fill="rgba(0,0,0,0.2)" stroke="black" stroke-width="2"/><line x1="32" y1="4" x2="32" y2="60" stroke="black" stroke-width="1"/><line x1="8" y1="20" x2="56" y2="44" stroke="black" stroke-width="1"/><line x1="56" y1="20" x2="8" y2="44" stroke="black" stroke-width="1"/></svg>');

        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }

      /* D12 ‚Üí pent√†gon */
      .d12 {
        background-color: #d83025;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><polygon points="32,4 60,24 49,60 15,60 4,24" fill="rgba(0,0,0,0.2)" stroke="black" stroke-width="2"/></svg>');
        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }

      /* D20 ‚Üí estel */
      .d20 {
        background-color: #f05a24;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="28" fill="rgba(0,0,0,0.1)" stroke="black" stroke-width="2"/><polygon points="32,4 44,20 60,24 48,36 52,56 32,44 12,56 16,36 4,24 20,20" fill="none" stroke="black" stroke-width="1"/></svg>');

        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }

      /* D100 ‚Üí cercle amb doble vora */
      .d100 {
        background-color: #22b473;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><circle cx="32" cy="32" r="28" fill="rgba(0,0,0,0.15)" stroke="black" stroke-width="2"/><circle cx="32" cy="32" r="16" fill="none" stroke="black" stroke-width="2"/></svg>');
        background-size: 70% 70%;
        background-repeat: no-repeat;
        background-position: center;
      }
      /* Animaci√≥ de tirada */
      @keyframes rollBounce {
        0% {
          transform: scale(1) rotate(0deg);
        }
        30% {
          transform: scale(1.2) rotate(10deg);
        }
        60% {
          transform: scale(0.9) rotate(-8deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      .roll-animate {
        animation: rollBounce 0.4s ease;
      }
      /* ===== BOTONS TIPUS DAU ===== */
      .dice-button {
        width: 60px;
        height: 60px;
        border-radius: 14px;
        border: none;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin: 8px;
        color: white;
        background: #444;
        box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.6);
        transition:
          transform 0.15s ease,
          background 0.2s ease;
      }
      .dice-button:hover {
        transform: scale(1.08);
        background: #555;
      }
      .btn-advantage {
        background: #16a085;
      }
      .btn-disadvantage {
        background: #e74c3c;
      }
      .btn-duality {
        background: linear-gradient(
          135deg,
          #f1c40f,
          #d4ac0d 45%,
          #8e44ad 55%,
          #6c3483
        );
        box-shadow:
          inset 0 0 12px rgba(0, 0, 0, 0.6),
          0 0 10px rgba(241, 196, 15, 0.3),
          0 0 10px rgba(142, 68, 173, 0.3);
        position: relative;
        overflow: hidden;
      }
      .btn-duality:hover {
        filter: brightness(1.1);
        transform: scale(1.08);
      }
      .esperanca-die {
        background: #f1c40f;
        color: black;
      }
      .por-die {
        background: #8e44ad;
      }
      .adv-die {
        background: #2ecc71;
        color: #000;
      }
      .dis-die {
        background: #e74c3c;
        color: #fff;
      }
      .adv-die::before {
        content: "+";
        font-weight: bold;
        margin-right: 2px;
      }
      .dis-die::before {
        content: "‚àí";
        font-weight: bold;
        margin-right: 2px;
      }
      .dice-icon {
        cursor: pointer;
      }
      .dice-icon:hover {
        transform: scale(1.1);
      }
      .modificador-fixe {
        background: #b3b3b3;
        color: #fff;
      }
      #toggleDice {
        color: #f1c40f;
        user-select: none;
        margin-bottom: 6px;
        transition: color 0.2s;
      }
      #toggleDice:hover {
        color: #f39c12;
      }
      #diceMenu {
        display: grid;
        grid-template-columns: 1fr 1fr; /* dos columnes */
        gap: 10px;
        padding: 12px;
        border-radius: 12px;
        background: #333; /* color de la pastilla */
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }
      @media (max-width: 500px) {
        #diceMenu {
          grid-auto-flow: row; /* torna a fila √∫nica */
          grid-template-columns: 1fr;
        }
      }
      .dice-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 0;
        padding: 0;
        background: none;
      }
      .critical {
        color: #f39c12;
        font-weight: bold;
        font-size: 18px;
        text-align: center;
        display: block;
        margin-top: 8px;
        animation: pulse 0.5s ease 0s 2;
      }
      /* Animaci√≥ de pulse */
      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.3);
        }
        100% {
          transform: scale(1);
        }
      }
      #fearContainer {
        display: flex;
        gap: 6px;
        flex-wrap: wrap;
        justify-content: center;
        min-height: 32px;
      }
      #fearContainerWrapper {
        margin-bottom: 20px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .fear-dot {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background-color: #999; /* fons gris clar */
        border: 2px solid #ccc;
        cursor: pointer;
        transition: background 0.3s;
      }
      .fear-dot.filled {
        background-color: #800080; /* morat */
      }
      #fearControls {
        display: flex;
        gap: 6px;
        margin-bottom: 6px;
        justify-content: center;
      }
      #playerName {
        padding: 8px;
        margin-bottom: 10px
      }
      #fixedModifier {
        display: none;
        margin-bottom: 10px;
        margin-top: 5px;
      }
      #modifierInput {
        width: 50px;
        text-align: center;
      }
      .site-footer {
        margin-top: 1rem;
        padding: 1rem 1rem;
        text-align: center;
/*         border-top: 1px solid #ddd; */
      }

      .logo-img {
        height: 40px;
        width: auto;
        opacity: 0.85;
        transition: opacity 0.2s ease, transform 0.2s ease;
      }

      .daggerheart-logo:hover .logo-img {
        opacity: 1;
        transform: scale(1.05);
      }
    </style>
  </head>

  <body>
    <div class="page">
      <h1 class="title">Corferit</h1>

      <div id="loginBox">
        <input type="email" id="email" placeholder="Identificador" /><br />
        <input
          type="password"
          id="password"
          placeholder="Paraula de pas"
        /><br />
        <button class="btn" onclick="login()">Entrar</button>
      </div>

      <div id="eines" style="display:none">
        <h3>Eines</h3>
      </div>

      <div id="app" style="display: none">
        <div id="roomLabel"></div>
        <div id="fearContainerWrapper">
          <div id="fearControls" style="display: none">
            <button id="fearMinus">-</button>
            <button id="fearPlus">+</button>
          </div>
          <div id="fearContainer"></div>
        </div>

        <input id="playerName" placeholder="Un nom"/>
        <br />

        <button class="dice-button btn-disadvantage" onclick="rollDuality(0)">
          Des
        </button>

        <button class="dice-button btn-duality" onclick="rollDuality()">
          ‚¨°‚¨¢
        </button>

        <button class="dice-button btn-advantage" onclick="rollDuality(1)">
          Av
        </button>

        <h3 id="toggleDice" style="cursor: pointer">‚ñ∫ Daus cl√†ssics</h3>

        <div id="diceContainer" style="display: none">
          <div id="diceMenu"></div>

          <div id="fixedModifier" class="counter">
            <button id="rstbtn" onclick="clearDice()">Neteja</button>
            &nbsp;&nbsp;&nbsp;
            <span>Mod. </span>
            <button onclick="changeFixedModifier(-1)">-</button>
            <input type="number" id="modifierInput" value="0"/>
            <button onclick="changeFixedModifier(1)">+</button>
          </div>

          <button class="btn" onclick="rollCustomDice()">Tirar daus</button>
        </div>

        <div id="result"></div>

        <h3>Historial</h3>
        <div id="history"></div>

        <br />
        <button class="btn" onclick="logout()">Tanca sessi√≥</button>
      </div>
    </div>

      <footer class="site-footer">
        <a href="https://daggerheart.com" target="_blank" rel="noopener" class="daggerheart-logo">
          <img src="DHCompatible.svg" alt="Daggerheart Compatible" class="logo-img">
        </a>
      </footer>


    <script type="module">
      // Firebase imports
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
      import {
        getFirestore,
        collection,
        addDoc,
        onSnapshot,
        query,
        orderBy,
        limit,
        doc,
        getDoc,
        getDocs,
        deleteDoc,
        setDoc,
        serverTimestamp,
        writeBatch,
      } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";
      import {
        getAuth,
        signInWithEmailAndPassword,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";

      // Firebase config
      const firebaseConfig = {
        apiKey: "AIzaSyCLRBsJDKcv9I0hf3uosB0F3w7rXWU-40A",
        authDomain: "corferit-daus.firebaseapp.com",
        projectId: "corferit-daus",
        storageBucket: "corferit-daus.firebasestorage.app",
        messagingSenderId: "756634249064",
        appId: "1:756634249064:web:8e09d8bf75aebcb1b118dd",
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const auth = getAuth(app);

      // Variables Globals.
      let currentRoomName = null;
      let currentRollsRef = null;

      // async function cleanOldRooms() {
      //   const roomsSnapshot = await getDocs(collection(db, "rooms"));
      //   const now = Date.now();
      //   const DAY = 24 * 60 * 60 * 1000;
      //
      //   roomsSnapshot.forEach(async (roomDoc) => {
      //     const data = roomDoc.data();
      //     if (data.createdAt && now - data.createdAt.toMillis() > DAY) {
      //       // borrar tirades.
      //       const rollsSnapshot = await getDocs(collection(db, `rooms/${roomDoc.id}/rolls`));
      //       rollsSnapshot.forEach(async (rollDoc) => {
      //         await deleteDoc(rollDoc.ref);
      //       });
      //
      //       // borrar sala.
      //       await deleteDoc(roomDoc.ref);
      //     }
      //   });
      // }

      async function cleanOldRooms(currentRoomName) {
        const roomsSnapshot = await getDocs(collection(db, "rooms"));
        const now = Date.now();
        const DAY = 24 * 60 * 60 * 1000;

        let batch = writeBatch(db);
        let operationsCount = 0;

        async function commitBatchIfFull() {
          if (operationsCount >= 450) { // 450 para estar seguros
            await batch.commit();
            console.log("Batch intermedio ejecutado");
            batch = writeBatch(db);
            operationsCount = 0;
          }
        }

        // ----------------------------
        // Limpiar rooms viejas
        // ----------------------------
        for (const roomDoc of roomsSnapshot.docs) {
          const roomId = roomDoc.id;
          const data = roomDoc.data();

          if (roomId === "sala-principal") continue;

          if (data.createdAt && data.createdAt.toMillis) {
            const roomAge = now - data.createdAt.toMillis();

            if (roomAge > DAY) {
              // Borrar rolls
              const rollsSnapshot = await getDocs(collection(db, "rooms", roomId, "rolls"));
              for (const rollDoc of rollsSnapshot.docs) {
                batch.delete(rollDoc.ref);
                operationsCount++;
                await commitBatchIfFull();
              }

              // Borrar room
              batch.delete(roomDoc.ref);
              operationsCount++;
              await commitBatchIfFull();
            }
          }
        }

        // ----------------------------
        // Limpiar rolls antiguos de la sala actual
        // ----------------------------
        if (currentRoomName) {
          const rollsSnapshot = await getDocs(collection(db, "rooms", currentRoomName, "rolls"));
          for (const rollDoc of rollsSnapshot.docs) {
            const rollData = rollDoc.data();
            if (rollData.time && rollData.time.toMillis) {
              const rollAge = now - rollData.time.toMillis();
              if (rollAge > DAY) {
                batch.delete(rollDoc.ref);
                operationsCount++;
                await commitBatchIfFull();
              }
            }
          }
        }

        // ----------------------------
        // Ejecutar batch final
        // ----------------------------
        if (operationsCount > 0) {
          try {
            await batch.commit();
            console.log("Batch final ejecutado, limpieza completada");
          } catch (e) {
            console.error("Error al ejecutar el batch final:", e);
          }
        }
      }

      // Sala desde URL amb el par√†metre *room* o *sala*.
      function getRoomFromURL() {
        const params = new URLSearchParams(window.location.search);
        return params.get("room") || params.get("sala") || "sala-general";
      }

      // LOGIN
      window.login = async function () {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;

        try {
          await signInWithEmailAndPassword(auth, email, password);
        } catch (error) {
          alert("Error de login: " + error.message);
        }
      };

      // LOGOUT
      window.logout = async function () {
        await signOut(auth);
      };

      // Comprovar si l'usuari √©s m√†ster.
      async function checkMaster(user) {
        const userRef = doc(db, "users", user.uid);
        const userSnap = await getDoc(userRef);

        if (userSnap.exists()) {
          const data = userSnap.data();
          return data.isMaster === true;
        }
        return false;
      }

      // Ens autentifiquem i pasen coses.
      onAuthStateChanged(auth, async (user) => {
        // Si no est√†s autentificat mostra el login i surt del bucle.
        if (!user) {
          document.getElementById("loginBox").style.display = "block";
          document.getElementById("app").style.display = "none";
          return;
        }

        if ((new URLSearchParams(window.location.search)).get("eines")) {
          document.getElementById("eines").style.display = "block";
        }

        // Per defecte (si est√†s autentificat) amaga la caixa de login i ensenya la app.
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("app").style.display = "block";

        const roomName = getRoomFromURL();
        if (roomName != "sala-general") {
          document.getElementById("roomLabel").innerText = "Sala: " + roomName;
        }

        // Intenta crear la sala a Firebase.
        const roomRef = doc(db, "rooms", roomName);
        const roomSnap = await getDoc(roomRef);
        if (!roomSnap.exists()) {
          try {
            await setDoc(roomRef, {
              name: roomName,
              createdAt: serverTimestamp(),
            });
          } catch (e) {
            console.warn("No tens permisos per crear aquesta sala.");
            return;
          }
        }

        // Creem l'historial de tirades.
        const rollsRef = collection(db, "rooms", roomName, "rolls");
        const q = query(rollsRef, orderBy("time", "desc"), limit(50));

        // Ara s√≠, inicialitzem les variables globals dins el bucle d'autentificaci√≥.
        currentRoomName = roomName;
        currentRollsRef = collection(db, "rooms", roomName, "rolls");

        cleanOldRooms(currentRoomName);

        const isMaster = await checkMaster(user);

        startApp({
          isMaster,
          roomName,
          rollsRef,
          q,
        });
      });

      // Firestore a temps real.
      function startApp({ isMaster, roomName, rollsRef, q }) {
        onSnapshot(q, (snapshot) => {
          const historyDiv = document.getElementById("history");
          historyDiv.innerHTML = "";
          snapshot.forEach((doc) => {
            const data = doc.data();
            let formattedTime = "";

            if (data.time && typeof data.time.toDate === "function") {
              formattedTime = data.time.toDate().toLocaleTimeString("es-ES", {
                hour: "2-digit",
                minute: "2-digit",
                second: "2-digit"
              });
            }
            historyDiv.innerHTML += `<div>[${formattedTime}] ${data.text}</div><hr>`;
          });
        });

        // Creem el menu de daus.
        createDiceMenu();

        // ==== CONTADOR DE POR ====
        let currentFear = 0;
        let maxFear = 12;

        const fearContainer = document.getElementById("fearContainer");
        const fearControls = document.getElementById("fearControls");
        const fearPlus = document.getElementById("fearPlus");
        const fearMinus = document.getElementById("fearMinus");

        // Renderiza los dots seg√∫n currentFear y maxFear
        function renderFearDots() {
          fearContainer.innerHTML = "";
          for (let i = 0; i < maxFear; i++) {
            const dot = document.createElement("div");
            dot.className = "fear-dot";
            if (i < currentFear) dot.classList.add("filled");

            if (isMaster) {
              // clic izquierdo = aumentar hasta ese punto
              dot.addEventListener("click", () => {
                currentFear = i + 1;
                updateFearDisplay();
                saveFear();
              });
              // clic derecho = disminuir hasta ese punto
              dot.addEventListener("contextmenu", (e) => {
                e.preventDefault();
                currentFear = i;
                updateFearDisplay();
                saveFear();
              });
            }

            fearContainer.appendChild(dot);
          }
        }

        // Actualiza el display sin tocar Firestore
        function updateFearDisplay() {
          const dots = document.querySelectorAll(".fear-dot");
          dots.forEach((dot, index) => {
            dot.classList.toggle("filled", index < currentFear);
          });
        }

        // Guardar en Firestore
        async function saveFear() {
          try {
            const fearRef = doc(db, "rooms", roomName, "fear", "counter");

            await setDoc(fearRef, { value: currentFear, max: maxFear });
          } catch (err) {
            console.error("Error guardando Fear en Firestore:", err);
          }
        }

        // Sincronizaci√≥n en tiempo real con Firestore
        const fearRef = doc(db, "rooms", roomName, "fear", "counter");

        onSnapshot(fearRef, (docSnap) => {
          if (docSnap.exists()) {
            const data = docSnap.data();
            currentFear = data.value ?? 0;
            maxFear = data.max ?? 12;
          }
          renderFearDots();
        });

        // Botones de a√±adir/quitar casillas
        fearPlus.addEventListener("click", () => {
          maxFear++;
          renderFearDots();
          saveFear();
        });
        fearMinus.addEventListener("click", () => {
          if (maxFear > 12) maxFear--;
          if (currentFear > maxFear) currentFear = maxFear;
          renderFearDots();
          saveFear();
        });

        // Mostrar controles solo si es master
        fearControls.style.display = isMaster ? "flex" : "none";

        // Render inicial para que se vean los dots aunque Firestore est√© vac√≠o
        renderFearDots();
      }
      //acaba startApp()

      // üé≤ Dados
      window.rollD12 = function () {
        return Math.floor(Math.random() * 12) + 1;
      };
      window.rollD6 = function () {
        return Math.floor(Math.random() * 6) + 1;
      };

      let fixedModifier = 0;

      window.changeFixedModifier = function (amount) {
        fixedModifier += amount;
        document.getElementById("modifierInput").value = fixedModifier;
      };
      document
        .getElementById("modifierInput")
        .addEventListener("input", (e) => {
          fixedModifier = parseInt(e.target.value) || 0;
        });
      let fixedModifierHTML = "";

      window.rollDuality = async function (v) {
        const esperan√ßa = rollD12();
        const por = rollD12();
        const d6 = rollD6();

        let winner = "";
        let final = esperan√ßa + por;
        let colorClass = "";
        let isCritical = false;

        if (esperan√ßa === por) {
          isCritical = true;
        }

        if (esperan√ßa >= por) {
          winner = "Esperan√ßa";
          colorClass = "esperan√ßa";
        } else {
          winner = "Por";
          colorClass = "por";
        }

        // Av/Des diferenciat
        let modifierHTML = "";

        if (v === 1) {
          final += d6;
          modifierHTML = `<span class="dice-icon adv-die roll-animate">${d6}</span>`;
        } else if (v === 0) {
          final -= d6;
          modifierHTML = `<span class="dice-icon dis-die roll-animate">${d6}</span>`;
        }

        const player =
          document.getElementById("playerName").value || auth.currentUser.email;

        let criticalHTML = "";
        if (isCritical) {
          criticalHTML = `<span class="critical">üéØ CR√çTIC! üéØ</span>`;
        }

        let finalWithModifier = final + fixedModifier;

        if (fixedModifier != 0) {
          fixedModifierHTML = `<span class="dice-icon modificador-fixe roll-animate">${fixedModifier >= 0 ? "+" : ""}${fixedModifier}</span>`;
        }
        // Versi√≥ animada amb Av/Des diferenciat
        const text = `
              <strong>${player}</strong><br><br>

              <span class="dice-icon esperanca-die roll-animate">${esperan√ßa}</span>
              <span class="dice-icon por-die roll-animate">${por}</span>
              ${modifierHTML}
              ${fixedModifierHTML}

              <br><br>
              <strong>${finalWithModifier}</strong> amb
              <span class="${colorClass}">${winner}</span>
              ${criticalHTML}
            `;

        document.getElementById("result").innerHTML = text;

        if (!currentRollsRef) {
          console.warn("La sala no est√° inicializada a√∫n");
          return;
        }

        await addDoc(currentRollsRef, {
          text: text,
          time: serverTimestamp(),
        });
      };
      const diceTypes = [3, 4, 6, 8, 10, 12, 20, 100];

      function createDiceMenu() {
        const container = document.getElementById("diceMenu");
        container.innerHTML = "";

        diceTypes.forEach((sides) => {
          const row = document.createElement("div");
          row.className = "dice-row";

          // Modo iconos pulsables
          row.innerHTML = `
                  <div class="dice-icon d${sides}" onclick="rollSingleDie(${sides})">
                    d${sides}
                  </div>
                  <div class="counter">
                    <button onclick="changeDice(${sides}, -1)">-</button>
                    <input type="number" id="dice-${sides}" value="0" min="0">
                    <button onclick="changeDice(${sides}, 1)">+</button>
                  </div>
                `;

          container.appendChild(row);
        });
      }

      window.clearDice = async function () {
        // Resetear selecci√≥n de dados
        diceTypes.forEach((sides) => {
          document.getElementById(`dice-${sides}`).value = 0;
        });

        // Resetear modificador fijo
        fixedModifier = 0;
        const modifierInput = document.getElementById("modifierInput");
        if (modifierInput) modifierInput.value = 0;
        fixedModifierHTML = "";
      };

      window.changeDice = function (sides, delta) {
        const input = document.getElementById(`dice-${sides}`);
        let value = parseInt(input.value) || 0;
        value += delta;
        if (value < 0) value = 0;
        input.value = value;
      };

      // Daus cl√†ssics
      window.rollCustomDice = async function () {
        let resultsHTML = "";
        let total = 0;
        let rolledSomething = false;

        diceTypes.forEach((sides) => {
          const qty =
            parseInt(document.getElementById(`dice-${sides}`).value) || 0;

          for (let i = 0; i < qty; i++) {
            const roll = Math.floor(Math.random() * sides) + 1;
            total += roll;
            rolledSomething = true;

            resultsHTML += `<span class="dice-icon d${sides} roll-animate">${roll}</span>`;
          }
        });

        if (!rolledSomething) {
          alert("No has seleccionado ning√∫n dado.");
          return;
        }

        let totalWithModifier = total + fixedModifier;

        const player =
          document.getElementById("playerName").value || auth.currentUser.email;

        if (fixedModifier != 0) {
          fixedModifierHTML = `<span class="dice-icon modificador-fixe roll-animate">${fixedModifier >= 0 ? "+" : ""}${fixedModifier}</span>`;
        }
        const text = `
              <strong>${player}</strong><br>
              ${resultsHTML}
              ${fixedModifierHTML}

              <br><br>
              <strong>Total: ${totalWithModifier}</strong>
              `;

        document.getElementById("result").innerHTML = text;
        if (!currentRollsRef) {
          console.warn("La sala no est√° inicializada a√∫n");
          return;
        }
        await addDoc(currentRollsRef, {
          text: text,
          time: serverTimestamp(),
        });
      };
      window.rollSingleDie = async function (sides) {
        const roll = Math.floor(Math.random() * sides) + 1;
        const player =
          document.getElementById("playerName").value || auth.currentUser.email;

        const resultHTML = `
              <strong>${player}</strong><br><br>
              <span class="dice-icon d${sides} roll-animate">${roll}</span>
              <br><br>
              <strong>Total: ${roll}</strong>
              `;

        document.getElementById("result").innerHTML = resultHTML;
        if (!currentRollsRef) {
          console.warn("La sala no est√° inicializada a√∫n");
          return;
        }
        await addDoc(currentRollsRef, {
          text: resultHTML,
          time: serverTimestamp(),
        });
      };
      const toggleDice = document.getElementById("toggleDice");
      toggleDice.addEventListener("click", () => {
        const container = document.getElementById("diceContainer");
        const modifierDiv = document.getElementById("fixedModifier");

        if (container.style.display === "none") {
          container.style.display = "block";
          modifierDiv.style.display = "block";
          toggleDice.innerText = "‚ñº Daus cl√†ssics";
        } else {
          container.style.display = "none";
          modifierDiv.style.display = "none";
          toggleDice.innerText = "‚ñ∫ Daus cl√†ssics";
        }
      });
    </script>
  </body>
</html>
